# Overview

api-fid.json encapsulates the current version of the FeatureIdentificationDevice 
(FID) Application Programming Interface (API) in a syntax that can easily be
read and processed by scripts and programs for schema validation and API
discovery.

# Command Attributes

## Required Attributes

- Opcode (a single byte in decimal or hex, e.g. "0x64" or "100")
- Direction ("HOST\_TO\_DEVICE" or "DEVICE\_TO\_HOST")
- Type (see below)

## Optional Attributes

- wIndex (a hard-coded constant expressed in decimal or hex)
- wValue (a hard-coded constant expressed in decimal or hex)
- Enum (ignored unless Type == "Enum"; a list of zero-indexed enum labels)
- Length (size of the buffer to send (pre-filled with nulls) or expect to receive; default 0)
- Range (list of two doubles; if provided, gives an informational range on the logical value being set; only relevant in host-to-device)
- ReadBack (how many bytes the host should read back from the device following a device-to-host transfer, if different from Length)
- ReadBackARM (overrides ReadBack on ARM architectures)
- Supports (list of board and sensor types, including any or all from ["ARM", "FX2", "InGaAs", "Silicon"])
- Uses (a list of any or all of the following: ["wValue", "wIndex"] which the user should be allowed to enter as parameters; default: ["wValue", "wIndex"]; only relevant in host-to-device)
- ARMInvertedReturn (bool; true if USB control transfer success value is inverted on ARM architectures; default false)
- FakeBufferLength (int; send the given buffer length to the device in the control transfer packet, even though no actual data is being sent)
- MakeFakeBufferFromValue (bool; generate a buffer of nulls whose length matches the wValue argument; default false)
- Reverse (bool; if true, reverse the ordering of the received bytes; default false; only relevant in device-to-host)
- Enabled (bool; whether the API command supported by current firmware; default true)
- Units (a string describing the unit of the relevant value, e.g. "milliseconds")
- Notes (free-form text comments about the command its arguments)

These are only for ACQUIRE\_CCD, and may be removed from the API:
- ReadEndpoint (optional; if bulk data is generated by a device-to-host transfer, load from this endpoint)
- ReadBlockSize (optional; 

## Type

These are the supported datatypes:

- Bool (wValue 0 or 1)
- Byte\[\] (raw series of bytes)
- Enum (also requires an "Enum" attribute with a list of zero-indexed enumeration labels)
- Float16 (a "funky float" used for Gain where the MSB is the integral value, and LSB is the fractional value)
- String (character data)
- Uint12 (12-bit DAC or ADC value)
- Uint16
- Uint16\[\] (pixel data)
- Uint32
- Uint40 (longer integers used for laser timing which span wValue, wIndex and finally MSB in an extra payload byte)
- Uint8

# History

- 2018-03-28 0.1.0
	- initial draft
